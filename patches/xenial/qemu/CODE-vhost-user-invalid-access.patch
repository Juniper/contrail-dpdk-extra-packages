diff -Naur a/net/vhost-user.c b/net/vhost-user.c
--- a/net/vhost-user.c	2017-07-06 16:17:24.799928000 -0700
+++ b/net/vhost-user.c	2017-07-10 12:06:57.505173000 -0700
@@ -178,6 +178,8 @@
     queues = qemu_find_net_clients_except(name, ncs,
                                           NET_CLIENT_OPTIONS_KIND_NIC,
                                           MAX_QUEUE_NUM);
+    assert(queues < MAX_QUEUE_NUM);
+ 
     s = DO_UPCAST(VhostUserState, nc, ncs[0]);
     trace_vhost_user_event(s->chr->label, event);
     switch (event) {
@@ -212,6 +214,9 @@
     VhostUserState *s;
     int i;
 
+    assert(name);
+    assert(queues > 0);
+
     for (i = 0; i < queues; i++) {
         nc = qemu_new_net_client(&net_vhost_user_info, peer, device, name);
 
@@ -225,7 +230,7 @@
     }
 
     qemu_chr_add_handlers(chr, net_vhost_user_can_receive, NULL,
-                          net_vhost_user_event, (void*)name);
+                          net_vhost_user_event, nc[0].name);
 
     return 0;
 }
